<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Formative Assessment</title>
  <style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
:root{
  --bg:#f7fafe; --card:#fff;
  --muted:#6b7280; --accent:#0b76ff; --success:#13a054;
  --danger:#dc2626;
  --radius:14px; --shadow:0 3px 14px rgba(11, 118, 255, 0.08);
}
*{box-sizing:border-box;font-family:'Inter',sans-serif}
body{margin:0; background:var(--bg); color:#132040;}
.wrap{min-height:100vh;display:flex;gap:1.2em;padding:1.2em;align-items:flex-start;justify-content:center}
.main{width:800px;max-width:95vw;display:flex;flex-direction:column;gap:16px}
.card{background:var(--card);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow)}
.brand-title{font-weight: 800; font-size: 2em; letter-spacing:0.02em; text-align:center; margin-bottom:2px; color:var(--accent);}
.brand-sub{color:var(--muted);text-align:center;font-size:1em;margin-bottom:16px;}
.nav{width:180px;background:linear-gradient(180deg,#09224c 0%, #153567 90%);color:#fff;border-radius:var(--radius);padding:1em;flex-shrink:0;display:flex;flex-direction:column;align-items:center;gap:14px;box-shadow:var(--shadow)}
.qgrid{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;width:100%;}
.qbtn{flex:0 1 38px;height:38px;border-radius:8px;border:none;background:#1b263c;color:#d5e2fb;font-weight:600;cursor:pointer;font-size:15px;transition:transform .12s}
.qbtn.current{background:var(--accent);color:#fff;}
.qbtn.done{background:var(--success);color:#fff;}
.qbtn.locked{background:#334155;color:#94a3b8;cursor:default}
input[type="text"]{padding:9px 13px;border-radius:8px;border:1px solid #b4c5e4;margin-right:10px;font-size:15px;}
.btn{background:var(--accent);color:#fff;padding:10px 20px;border-radius:8px;border:none;cursor:pointer;font-weight:700;}
.btn.ghost{background:transparent;border:1.5px solid #b4c5e4;color:#204b88;}
.btn.danger{background:var(--danger);}
.btn:disabled{opacity:.7;cursor:not-allowed;}
.start-actions{display:flex;gap:10px;}
.inputs{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:10px;}
.qwrap{display:flex;flex-direction:column;gap:14px;}
.qnum{font-weight:700;font-size:18px;}
.qcard{padding:18px 0 8px 0;}
.qtext{font-weight:700;font-size:1.16em;margin-bottom:13px;}
.options{display:flex;flex-direction:column;gap:11px;}
.option{background:#f4f7fb;border:1.5px solid #dde4ee;padding:12px 10px;border-radius:8px;cursor:pointer;display:flex;align-items:center;gap:10px;transition:.15s}
.option.selected{background:linear-gradient(90deg,#e8f0ff,#f4f6ff);border-color:#bcd;}
.option.locked{opacity:.6;cursor:default;}
.bottom-bar{margin-top:18px;display:flex;justify-content:space-between;align-items:center;}
.timer-group{display:flex;gap:1em;align-items:center;}
.timer-label{color:var(--muted);font-size:15px;}
.big-timer{font-weight:700;font-size:22px;color:var(--accent);}
.countdown-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9000;color:#fff}
.count-text{font-size:22px;margin-bottom:9px;}
.count-num{font-size:70px;font-weight:900;}
.hidden{display:none!important}
@media(max-width:950px){.wrap{flex-direction:column-reverse;}.nav{flex-direction:row;width:100%;padding:10px;gap:10px;}}
@media(max-width:500px){.main{width:100%}.card{padding:11px;}.qtext{font-size:1em;}}
  </style>
</head>
<body>

<div class="wrap">
  <!-- Left NAVIGATION -->
  <aside class="nav card" id="navPane">
    <div class="brand-title" style="font-size:1.3em;color:#fff;">Assessment</div>
    <div class="qgrid" id="navGrid"></div>
  </aside>

  <!-- QUIZ MAIN PANEL -->
  <main class="main">

    <!-- TITLE, SUBTITLE, TIMER -->
    <div class="card" style="margin-bottom:-5px">
      <div class="brand-title">FORMATIVE ASSESSMENT</div>
      <div class="brand-sub">40 questions &bull; 20 seconds each &bull; Single attempt &bull; Auto-timers</div>
      <div class="timer-group" style="justify-content:center;margin-top:3px;">
        <span class="timer-label">Total Time Left:</span>
        <span class="big-timer" id="totalTimer">-- s</span>
      </div>
    </div>

    <!-- START SCREEN -->
    <section class="card" id="startScreen">
      <div style="text-align:center;">
        <div style="font-weight:700;font-size:19px;margin-bottom:5px;">Enter your details to begin</div>
        <div class="inputs">
          <label><input id="nameInput" type="text" placeholder="Full name" autocomplete="name"></label>
          <label><input id="rollInput" type="text" placeholder="Roll / ID" autocomplete="off"></label>
        </div>
        <div class="start-actions">
          <button class="btn" id="startBtn">Start Test</button>
        </div>
      </div>
    </section>

    <!-- QUIZ -->
    <section class="card hidden" id="quizArea">
      <div class="qwrap">
        <div class="qnum" id="qNum"></div>
        <div class="qcard">
          <div class="qtext" id="qText"></div>
          <div class="options" id="optionsList"></div>
        </div>
        <div class="bottom-bar">
          <button class="btn ghost" id="prevBtn">Prev</button>
          <div style="display:flex;gap:13px;align-items:center;">
            <div>
              <span class="timer-label">Time left for this question:</span>
              <span class="big-timer" id="qTimer">20s</span>
            </div>
            <button class="btn" id="nextBtn">Next</button>
            <button class="btn danger" id="endBtn">End Test</button>
          </div>
        </div>
      </div>
    </section>

    <!-- END / SUBMISSION -->
    <section class="card hidden" id="endScreen">
      <div style="text-align:center;">
        <div class="brand-title" style="color:var(--success);font-size:1.7em;">Test Submitted</div>
        <div id="submitMsg" style="font-weight:600;font-size:18px;margin:20px 0;">Your answers have been recorded.<br>Thank you!</div>
      </div>
    </section>
  </main>
</div>

<!-- countdown overlay -->
<div id="countOverlay" class="countdown-overlay hidden">
  <div class="count-text">Test starting in...</div>
  <div class="count-num" id="countNum">3</div>
</div>

<script>
const PER_Q_SECONDS = 20;
const QUESTIONS = [
  { text:"Most common cause of acute appendicitis?", opts:{A:"Lymphoid hyperplasia",B:"Fecalith",C:"Foreign body",D:"Tumor"} },
  { text:"Preferred incision for open appendectomy?", opts:{A:"Midline",B:"McBurney’s",C:"Lanz",D:"Grid iron"} },
  { text:"Commonest site of peptic ulcer?", opts:{A:"Fundus",B:"Duodenum",C:"Body",D:"Cardia"} },
  { text:"Best investigation for gallstones?", opts:{A:"CT",B:"Ultrasound",C:"MRI",D:"ERCP"} },
  { text:"Most common cause of upper GI bleed?", opts:{A:"Mallory–Weiss tear",B:"Duodenal ulcer",C:"Gastric ulcer",D:"Varices"} },
  { text:"Most common thyroid malignancy?", opts:{A:"Follicular",B:"Papillary",C:"Medullary",D:"Anaplastic"} },
  { text:"Gold standard for diagnosing Hirschsprung’s disease?", opts:{A:"X-ray",B:"Biopsy",C:"Manometry",D:"CT"} },
  { text:"Preferred treatment for acute cholecystitis?", opts:{A:"Elective cholecystectomy",B:"Early cholecystectomy",C:"Medical therapy",D:"ERCP"} },
  { text:"Most common cause of intestinal obstruction in adults?", opts:{A:"Volvulus",B:"Adhesions",C:"Hernia",D:"Tumor"} },
  { text:"Most common type of hernia overall?", opts:{A:"Femoral",B:"Indirect inguinal",C:"Direct inguinal",D:"Umbilical"} },
  { text:"First step in management of tension pneumothorax?", opts:{A:"Chest tube",B:"Needle decompression",C:"Oxygen",D:"CT chest"} },
  { text:"Most common cause of splenomegaly in India?", opts:{A:"Malaria",B:"Leukemia",C:"Cirrhosis",D:"Lymphoma"} },
  { text:"Investigation of choice for pancreatic carcinoma?", opts:{A:"Ultrasound",B:"CT scan",C:"MRI",D:"ERCP"} },
  { text:"Most common cause of painless lower GI bleed in elderly?", opts:{A:"Hemorrhoids",B:"Diverticulosis",C:"Polyps",D:"Cancer"} },
  { text:"Which suture is absorbable?", opts:{A:"Silk",B:"Nylon",C:"Vicryl",D:"Prolene"} },
  { text:"Most common site of breast carcinoma?", opts:{A:"Upper inner quadrant",B:"Upper outer quadrant",C:"Lower outer quadrant",D:"Central"} },
  { text:"Most common cause of acute mesenteric ischemia?", opts:{A:"Venous thrombosis",B:"Arterial embolism",C:"Non-occlusive",D:"Atherosclerosis"} },
  { text:"What is Courvoisier’s law associated with?", opts:{A:"Gallstones",B:"Carcinoma head of pancreas",C:"Cholangitis",D:"Acute hepatitis"} },
  { text:"Most common cause of post-thyroidectomy stridor?", opts:{A:"Tracheomalacia",B:"Hematoma",C:"B/L RLN palsy",D:"Edema"} },
  { text:"First line for variceal bleed prophylaxis?", opts:{A:"Nitrates",B:"Propranolol",C:"Octreotide",D:"Endoscopic banding"} },
  { text:"What is Murphy’s sign used for?", opts:{A:"Appendicitis",B:"Cholecystitis",C:"Pancreatitis",D:"PUD"} },
  { text:"Most common cause of massive splenomegaly?", opts:{A:"CML",B:"Cirrhosis",C:"Malaria",D:"Kala-azar"} },
  { text:"Most common cause of gastric outlet obstruction?", opts:{A:"Pyloric carcinoma",B:"Peptic ulcer disease",C:"Foreign body",D:"Polyp"} },
  { text:"Which nerve is injured in hernia repair?", opts:{A:"Ilioinguinal",B:"Femoral",C:"Obturator",D:"Lateral cutaneous"} },
  { text:"Most common site of diverticulosis?", opts:{A:"Rectum",B:"Sigmoid colon",C:"Ascending colon",D:"Cecum"} },
  { text:"Best investigation for achalasia cardia?", opts:{A:"Endoscopy",B:"Barium swallow",C:"CT chest",D:"Manometry"} },
  { text:"Which artery is ligated in PPH surgery?", opts:{A:"Internal iliac",B:"Uterine",C:"Ovarian",D:"Inferior mesenteric"} },
  { text:"Most common cause of hepatocellular carcinoma?", opts:{A:"Alcohol",B:"Hepatitis B",C:"Hepatitis C",D:"Hemochromatosis"} },
  { text:"Most common cause of lower limb ischemia?", opts:{A:"Embolism",B:"Thrombosis",C:"Trauma",D:"Aneurysm"} },
  { text:"Best test for diagnosing DVT?", opts:{A:"Venography",B:"Doppler ultrasound",C:"MRI",D:"CT"} },
  { text:"Most common type of shock in trauma?", opts:{A:"Cardiogenic",B:"Hypovolemic",C:"Septic",D:"Neurogenic"} },
  { text:"Which is the most radiosensitive tumor?", opts:{A:"Lymphoma",B:"Osteosarcoma",C:"Glioma",D:"Melanoma"} },
  { text:"Most common cause of small bowel obstruction in children?", opts:{A:"Adhesions",B:"Intussusception",C:"Hernia",D:"Volvulus"} },
  { text:"Best prognostic factor in breast cancer?", opts:{A:"Tumor size",B:"Axillary node status",C:"Grade",D:"Hormone receptor"} },
  { text:"Most common cause of acute limb ischemia?", opts:{A:"Trauma",B:"Embolism",C:"Thrombosis",D:"Vasculitis"} },
  { text:"Most common site of oral cancer?", opts:{A:"Floor of mouth",B:"Tongue (lateral)",C:"Buccal mucosa",D:"Hard palate"} },
  { text:"Commonest cause of splenic rupture?", opts:{A:"Trauma",B:"Malaria",C:"Mononucleosis",D:"Hematoma"} },
  { text:"Most common benign breast tumor?", opts:{A:"Fibroadenoma",B:"Phyllodes",C:"Papilloma",D:"Cyst"} },
  { text:"What is Kehr’s sign?", opts:{A:"Pain to right shoulder",B:"Pain to left shoulder",C:"Epigastric pain",D:"Back pain"} },
  { text:"Safest site for chest tube insertion?", opts:{A:"2nd ICS midclavicular",B:"5th ICS midaxillary",C:"6th ICS anterior axillary",D:"4th ICS midclavicular"} }
];
const totalQuestions=QUESTIONS.length;
let current=0,selected=Array(totalQuestions).fill(null);
let perRemaining=Array(totalQuestions).fill(PER_Q_SECONDS);
let totalSeconds=totalQuestions*PER_Q_SECONDS;
let qInterval,totalInterval;
let testStarted=false;

const startScreen=document.getElementById('startScreen');
const quizArea=document.getElementById('quizArea');
const endScreen=document.getElementById('endScreen');
const nameInput=document.getElementById('nameInput');
const rollInput=document.getElementById('rollInput');
const qNumEl=document.getElementById('qNum');
const qText=document.getElementById('qText');
const optionsList=document.getElementById('optionsList');
const qTimerEl=document.getElementById('qTimer');
const totalTimerEl=document.getElementById('totalTimer');
const prevBtn=document.getElementById('prevBtn');
const nextBtn=document.getElementById('nextBtn');
const endBtn=document.getElementById('endBtn');
const navGrid=document.getElementById('navGrid');
const countOverlay=document.getElementById('countOverlay');
const countNum=document.getElementById('countNum');
const submitMsg=document.getElementById('submitMsg');

/* Always start fresh */
localStorage.clear();

function buildNav(){
  navGrid.innerHTML='';
  for(let i=0;i<totalQuestions;i++){
    const b=document.createElement('button');
    b.className='qbtn';
    b.id='nav-'+i;
    b.innerText=i+1;
    b.onclick=()=>jumpTo(i);
    navGrid.appendChild(b);
  }
  refreshNav();
}
function refreshNav(){
  for(let i=0;i<totalQuestions;i++){
    const btn=document.getElementById('nav-'+i);
    if(!btn) continue;
    btn.classList.toggle('current',i===current);
    btn.classList.toggle('done',selected[i]!==null);
  }
}
function renderQuestion(idx){
  current=idx;
  qNumEl.innerText=`Question ${current+1} of ${totalQuestions}`;
  qText.innerText=QUESTIONS[current].text;
  optionsList.innerHTML='';
  ['A','B','C','D'].forEach(letter=>{
    const wrap=document.createElement('label');
    wrap.className='option';
    if(selected[current]===letter) wrap.classList.add('selected');
    const radio=document.createElement('input');
    radio.type='radio';
    radio.name='q'+current;
    radio.value=letter;
    radio.checked=(selected[current]===letter);
    radio.onchange=()=>{
      selected[current]=letter;
      document.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
      wrap.classList.add('selected');
      refreshNav();
    };
    wrap.append(radio,document.createTextNode(`${letter}. ${QUESTIONS[current].opts[letter]}`));
    optionsList.appendChild(wrap);
  });
  qTimerEl.innerText=perRemaining[current]+'s';
  refreshNav();
}

function startQTimer(){
  clearInterval(qInterval);
  qInterval=setInterval(()=>{
    perRemaining[current]--;
    qTimerEl.innerText=perRemaining[current]+'s';
    if(perRemaining[current]<=0){
      clearInterval(qInterval);
    }
  },1000);
}
function startTotalTimer(){
  clearInterval(totalInterval);
  totalInterval=setInterval(()=>{
    totalSeconds--;
    totalTimerEl.innerText=totalSeconds+'s';
    if(totalSeconds<=0){
      clearInterval(totalInterval);
      finishTest();
    }
  },1000);
}

function jumpTo(idx){
  clearInterval(qInterval);
  renderQuestion(idx);
  startQTimer();
}

document.getElementById('startBtn').onclick=()=>{
  if(!nameInput.value.trim()||!rollInput.value.trim()){
    alert('Enter name and roll ID');
    return;
  }
  startScreen.classList.add('hidden');
  countOverlay.classList.remove('hidden');
  let c=3;
  countNum.innerText=c;
  const countdown=setInterval(()=>{
    c--;
    if(c<=0){
      clearInterval(countdown);
      countOverlay.classList.add('hidden');
      quizArea.classList.remove('hidden');
      buildNav();
      jumpTo(0);
      startTotalTimer();
      testStarted = true;
    }else{
      countNum.innerText=c;
    }
  },1000);
};
prevBtn.onclick=()=>{ if(current>0) jumpTo(current-1); };
nextBtn.onclick=()=>{ if(current<totalQuestions-1) jumpTo(current+1); };
endBtn.onclick=()=>finishTest();

function finishTest(){
  if(qInterval) clearInterval(qInterval);
  if(totalInterval) clearInterval(totalInterval);
  quizArea.classList.add('hidden');
  endScreen.classList.remove('hidden');
}

/* Navigation by clicking nav number buttons always allowed */
</script>
</body>
</html>
